---
output:
  html_document: default
  word_document: default
  pdf_document: default
---
```{r knitr_setup, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(cache=TRUE)
library(tidyverse)
```

## Tutorial: An Analysis of Roger Federer, Rafael Nadal and Novak Djokovic in Grand Slams

### Background
Currently, tennis is experiencing the end of a "Golden Age". Right now, there are three all time greats competing at the highest stage; all while being at the closing door of their careers. These three are Roger Federer, Rafael Nadal and Novak Djokovic.

Roger Federer is widely considered the greatest of all time (GOAT). He has broken countless records and received many awards. Even at the age of 36, Roger Federer still is at the top of the rankings and continues to be a favorite for all of the biggest tournaments.

Rafael Nadal is considered the other main contender for greatest tennis player of all time status. He is considered the greatest clay court player of all time and joins Federer at the top of the rankings even today, at the age of 31

Novak Djokovic is the youngest of the three, and after playing 3rd fiddle to Federer and Nadal, burst on to the scene in 2011 to take the crown at the top and completely dominate the tour at unprecedented levels from 2011 to 2016. Although he does not yet have the career accomplishments to equal Roger Federer or Rafael Nadal, he is considered a huge threat to his legacy. He is currently recovering from surgery at the moment, but could return into grand slam winning for soon.

One of the biggest contributors to the GOAT (Greatest of All Time) status are Grand Slam tournaments. There are four Grand Slam tournaments each year. These four tournaments, are the most prestigious tournaments in tennis and winning the trophy at one of these four tournaments is considered a great legacy. In the last 12 years, there were only 7 different grand slam champions. Roger Federer, Rafael Nadal and Novak Djokovic have held a sustained period of dominance over grand slams, winning a combined 48 out of the last 59 slams. (Federer winning 20, Nadal winning 16, Djokovic winning 12)

This tutorial will take you through the entire data science pipeline, as we explore the performance of these three all time greats in the grand slam tournaments that they've participated in throughout their careers.

### Data Curation
First we need to gather data for all grand slam tournaments. We can find all ATP Men's matches from 2000 to 2016 at this link:
https://www.kaggle.com/jordangoblet/atp-tour-20002016

For Tennis Fans: It is important to note that Federer and Nadal have won a combined total of 5 grand slams in 2017 and 2018. This data will be missing and not be included in the study due to the statistics not being released by the ATP world tour.

As you can see below, we have loaded the data.

```{r load_data, message=FALSE}
tennis <- read.csv("/Users/Devin/Documents/Data.csv")
tennis %>% slice(1:10)
```

### Data Parsing
First, since this tutorial only concerns grand slam matches, we can filter out all non grand slam matches.
So, let's put the matches into a pipeline and use filter to keep all matches with a Series attribute of "Grand Slam"

```{r}
slamMatches <- tennis %>%
  filter(Series == "Grand Slam") 
slamMatches %>% slice(1:10)
```

Now, let's get the individual matches for each player we are interested in. We can use filter to grab all of Federer, Nadal and Djokovic's wins. We are only interested in their wins for this tutorial.

```{r}
federerMatches <- slamMatches %>%
  filter(Winner == "Federer R.")
federerMatches %>% slice(1:10)

nadalMatches <- slamMatches %>%
  filter(Winner == "Nadal R.")
nadalMatches %>% slice(1:10)

djokovicMatches <- slamMatches %>%
  filter(Winner == "Djokovic N.")
djokovicMatches %>% slice(1:10)
```

My pipeline grabs the first 10 best of 5 that Roger Federer has won and started very strong (Lopsided score in the first set).
I think this is useful because it shows me which players may be either slow starters against Federer or simply good matchups for Federer

Here is the step by step process:

First I grab all best of 5 by filtering out matches that are best of 3 (I can do this by simply checking whether best.of is greater than three, because the value will either be 3 or 5). 

Then I filter out all matches that do not have federer as the winner.

Now, I only want to display the attributes: Tournament, Date, Winner, Loser, W1, L1, W2, L2, W3, L3, W4, L4, W5 and L5 because I want to know only basic information about the matches, like the winner, loser and set scores, so I selected only those attributes to display. 

Now I sort by Loser's score in increasing order, so the lowest first set loser's score will be first.

Now I rename the Winner category to Federer, since we know it will be him as the winner.

Now I used the slice operation to take the first 10 entities only, allowing me to get the most lopsided first set scores

```{r pipeline}
fedMatches <- tennis %>%
  filter(Best.of > 3) %>%
  filter(Winner == "Federer R.") %>%
  select(Tournament, Date, Winner, Loser, W1, L1, W2, L2, W3, L3, W4, L4, W5, L5) %>%
  arrange(L1) %>%
  rename(Federer=Winner) %>%
  slice(1:10)
fedMatches
```


### Data Management

### Exploratory Data Analysis

1) This plot shows the Federer's score in set 2 in relation to the loser's score in set 2

Why did I use this plot? Because I wanted to see if the score of the second set improves from the first set score, which means that the opponent stepped up their game from the first set.

NOTE: Because of the nature of my pipeline, I already know that Federer was able to beat the loser either 6-0 or 6-1 in the first set.

As seen in the plot, the minimum number of games in the second set is 3, so after losing the first set 6-0 or 6-1, every single opponent raised their game to lose the second set at least 6-3 or higher. The plot however shows that nobody on the list was able to win the second set however, which can be seen since Federer's set 2 score is always higher than the loser's set 2 score.

```{r plot}
fedMatches %>%
  ggplot(mapping=aes(x=W2, y=L2)) +
    geom_point()
```

### Hypothesis Testing

### Machine Learning

### Message